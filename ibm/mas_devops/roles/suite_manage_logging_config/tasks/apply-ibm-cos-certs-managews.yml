---
- name: Add the IBM COS certificates in ManageWorkspace CR
  community.kubernetes.k8s:
    merge_type: merge
    definition:
      apiVersion: apps.mas.ibm.com/v1
      kind: ManageWorkspace
      metadata:
        name: "{{ mas_instance_id }}-{{ mas_workspace_id }}"
        namespace: "mas-{{ mas_instance_id }}-manage"
      spec:
        settings:
          deployment:
            loggingS3Destination:
              accessKey: "{{ cos_access_key_id }}"
              bucketName: "{{ cos_bucket_name }}"
              endpointURL: "{{ cos_url }}"
              secretKey:
                secretName: "s3secretkey"
            importedCerts:
              - alias: ibmcoscertpart1
                crt: |-
                  {{ cos_tls_crt[0] }}
              - alias: ibmcoscertpart2
                crt: |-
                  {{ cos_tls_crt[1] }}
              - alias: ibmcoscertpart3
                crt: |-
                  {{ cos_tls_crt[2] }}