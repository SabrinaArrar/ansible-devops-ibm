---
# 1. Obtain Private IP, if not provided, but Fyre credentials are
# -----------------------------------------------------------------------------
- name: "Get Cluster Details"
  uri:
    url: "{{ fyre_api_get_cluster_info }}"
    user: "{{ fyre_username }}"
    password: "{{ fyre_password }}"
    method: GET
    force_basic_auth: yes
    validate_certs: false
  register: _cluster_details

- name: "Get Private IP"
  shell:
    echo "{{ _cluster_details }}" | jq -cr '.json.clusters[].vms[] | select (.hostname | contains("api")) | .ips[] | select (.type | contains("private")) | .address'
  register: fyre_inf_node_private_ip

- name: debug
  debug:
    var: fyre_inf_node_private_ip
