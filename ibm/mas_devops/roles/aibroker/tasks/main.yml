---
- name: Load variables (main)
  include_vars: "vars/main.yml"

# install AI Broker api
# - include_tasks: tasks/aibroker/main.yml

# - name: Create entitlement
#   command: python3 {{ role_path }}/files/create_entitlement.py standard pcc 10 1 1 10000 100 1MB
#   register: create_entitlement
#   ignore_errors: yes

# curl -X 'POST' \
#   'http://localhost:8080/ibm/aibroker/service/rest/api/v1/tenant' \
#   -H 'accept: */*' \
#   -H 'Content-Type: application/json' \
#   -d '{
#   "tenant_name": "karol_tenant",
#   "sls_url": "karol_tenant_sls",
#   "dro_url": "karol_tenant_dro_url"
# }'

# create AI Broker api key
- include_tasks: tasks/apikey/main.yml

# read api and setfacts

- name: Create tenant and add to db2 for saas
  shell: |
    curl -k -X POST "https://aibroker.aibdev.apps.aibrokerdev.cp.fyre.ibm.com/ibm/aibroker/service/rest/api/v1/tenant" \
    --header 'apikey: OzKQck2Bh1OaxqizJ1d1SXufMXNfophE' \
    --header 'accept: */*' \
    --header 'Content-Type: application/json' \
    --header 'tenantid: aibroker-user' \
    --data ' {"tenant_name": "aibroker-user", "sls_url": "karol_tenant_sls", "dro_url": "karol_tenant_dro_url"}'

# create AI Broker tenant
- include_tasks: tasks/tenant/main.yml

# create s3 api key
- include_tasks: tasks/s3/main.yml

# create wx api
- include_tasks: tasks/watsonx/main.yml
