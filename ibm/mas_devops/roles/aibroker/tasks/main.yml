---
- name: Load variables (main)
  include_vars: "vars/main.yml"

- name: "patch pipeline-runner-instance SA"
  # shell: oc patch sa -n {{ aibroker_namespace }} pipeline-runner-instance --type='merge' -p '{"imagePullSecrets":[{"name":"regcred"}]}'
  #shell: oc patch sa -n {{ aibroker_namespace }} pipeline-runner-instance --type='merge' -p '{"imagePullSecrets":[{"name":"ibm-entitlement"}]}'
  shell: oc patch sa -n {{ aibroker_namespace }} pipeline-runner-instance --type='merge' -p '{"imagePullSecrets":[{"name":"{{ pullSecretName }}"}]}'
  register: patch_output

- include_tasks: tasks/aibroker/main.yml

- include_tasks: tasks/tenant/main.yml

- include_tasks: tasks/apikey/main.yml

- include_tasks: tasks/s3/main.yml

- include_tasks: tasks/watsonx/main.yml
