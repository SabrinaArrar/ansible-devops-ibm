---
# 1. Check required properties
# -----------------------------------------------------------------------------
- name: "Check required properties"
  assert:
    that:
      - dns_provider is defined and dns_provider != ""
      - mas_instance_id is defined and mas_instance_id != ""


# 2. Use CIS to set DNS and the custom cluster provider
# -----------------------------------------------------------------------------
- include_tasks: tasks/providers/cloudflare/main.yml
  when: dns_provider == "cloudflare"


# 3. Use CIS to set DNS and the custom cluster provider
# -----------------------------------------------------------------------------
- include_tasks: tasks/providers/cis/main.yml
  when: dns_provider == "cis"


# 4. Set custom cp4d route based on the custom cluster issuer
# -----------------------------------------------------------------------------
- include_tasks: tasks/cp4d.yml
  when: cpd_instance_namespace is defined and cpd_instance_namespace != ""
