---
# 1. Check required properties
# -----------------------------------------------------------------------------
- name: "Check required properties"
  assert:
    that:
      - dns_provider is defined and dns_provider != ""
      - dns_provider is in ['cis', 'cloudflare']
      - mas_instance_id is defined and mas_instance_id != ""


# 2. Run provider task
# -----------------------------------------------------------------------------
- include_tasks: tasks/providers/{{ dns_provider }}.yml


# 3. Set custom cp4d route based on the custom cluster issuer
# -----------------------------------------------------------------------------
- include_tasks: tasks/cp4d.yml
  when: cpd_instance_namespace is defined and cpd_instance_namespace != ""
