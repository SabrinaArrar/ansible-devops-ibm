---
- include_tasks: tasks/providers/cis/cis_dns_mgmt.yml

- name: "cis : login to IBM Cloud"
  shell: |
    ibmcloud login --apikey "{{ cis_apikey }}" -q --no-region
  retries: 10
  delay: 60 # 1 minute

- name: "Pause for 2 minutes before continuing..."
  pause:
    minutes: 2

- include_tasks: tasks/providers/cis/cis_edge_certificate.yml

- name: "Pause for 2 minutes before continuing..."
  pause:
    minutes: 2

# Load the WAF rules to disable
- name: "cis : WAF rules to disable"
  include_vars: vars/waf_rules_to_disable.yml

- name: "Pause for 2 minutes before continuing..."
  pause:
    minutes: 2

- include_tasks: tasks/providers/cis/cis_waf_rule.yml
  loop: "{{ waf_rules_to_disable }}"

- name: "Pause for 2 minutes before continuing..."
  pause:
    minutes: 2

- include_tasks: tasks/providers/cis/cis_domain_setting.yml
