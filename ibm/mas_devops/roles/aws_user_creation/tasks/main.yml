---
# 1. Provide debug information to the user
# -----------------------------------------------------------------------------
- name: "Debug information"
  debug:
    msg:
      - "AWS Region.............................. {{ aws_region }}"
      - "AWS User Name readonly ................. {{ aws_bucket_read_only_username }}"
      - "AWS User Name readwrite ................ {{ aws_bucket_read_write_username }}"
      - "AWS Bucket ARN ......................... {{ aws_bucket_arn }}"

- include_tasks: "tasks/create-readonly-policy.yml"

- include_tasks: "tasks/create-readwrite-policy.yml"

- name: Debug IAM Policy ARN's
  debug:
    msg:
      - "{{ s3readonly_policy_arn }}"
      - "{{ s3readwrite_policy_arn }}"

- name: "Create read-only user {{ aws_bucket_read_only_username }}"
  include_tasks: "tasks/create-user.yml"
  vars:
    aws_username: "{{ aws_bucket_read_only_username }}"
    aws_policy_arn: "{{ s3readonly_policy_arn }}"
  
- name: "Create read-write user {{ aws_bucket_read_write_username }}"
  include_tasks: "tasks/create-user.yml"
  vars:
    aws_username: "{{ aws_bucket_read_write_username }}"
    aws_policy_arn: "{{ s3readwrite_policy_arn }}"
