---
- name: Retrieve Manage workspace CR
  kubernetes.core.k8s_info:
    api_version: apps.mas.ibm.com/v1
    name: "{{ mas_ws_cr_name }}"
    namespace: "{{ manage_namespace }}"
    kind: workspaceCR
  register: workspaceCR

- name: Check if Civil is enabled
  set_fact:
    civilEnabled: "{{ workspaceCR.resources[0].status.components.civil is defined and workspaceCR.resources[0].status.components.civil.enabled }}"

- name: Configure stitching
  include_tasks: tasks/configure-stitching.yml
  when:
    - civilEnabled
