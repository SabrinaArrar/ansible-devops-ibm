<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/roles/suite_app_backup_restore/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Backup and Restore MAS Applications - MAS Devops Collection</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Backup and Restore MAS Applications";
        var mkdocs_page_input_path = "roles/suite_app_backup_restore.md";
        var mkdocs_page_url = "/ansible-devops/roles/suite_app_backup_restore/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MAS Devops Collection
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Playbooks</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/ocp/">OCP</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/cp4d/">Install Cloud Pak For Data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-core/">Install Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-iot/">Add IoT</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-manage/">Add Manage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-monitor/">Add Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-optimizer/">Add Optimizer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-predict/">Add Predict</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-visualinspection/">Add Visual Inspection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-update/">Update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/oneclick-upgrade/">Upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/uninstall-core/">Uninstall Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../playbooks/backup-restore/">Backup & Restore</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: OCP Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_cluster_monitoring/">ocp_cluster_monitoring</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_config/">ocp_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_deprovision/">ocp_deprovision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_efs/">ocp_efs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_github_oauth/">ocp_github_oauth</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_login/">ocp_login</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_node_config/">ocp_node_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_provision/">ocp_provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_roks_upgrade_registry_storage/">ocp_roks_upgrade_registry_storage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_upgrade/">ocp_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_verify/">ocp_verify</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Dependency Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../appconnect/">appconnect</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_bucket_access_point/">aws_bucket_access_point</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_documentdb_user/">aws_documentdb_user</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_policy/">aws_policy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_route53/">aws_route53</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_user_creation/">aws_user_creation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../aws_vpc/">aws_vpc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cert_manager/">cert_manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cis/">cis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../common_services/">common-services</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../configure_manage_eventstreams/">configure_manage_eventstreams</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cos/">cos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cos_bucket/">cos_bucket</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d_admin_pwd_update/">cp4d_admin_pwd_update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d/">cp4d</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d_service/">cp4d_service</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../db2/">db2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../dro/">dro</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../grafana/">grafana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ibm_catalogs/">ibm_catalogs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kafka/">kafka</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nvidia_gpu/">nvidia_gpu</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mongodb/">mongodb</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocs/">ocs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sls/">sls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../turbonomic/">turbonomic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uds/">uds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Image Mirroring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_case_prepare/">mirror_case_prepare</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_extras_prepare/">mirror_extras_prepare</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_images/">mirror_images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../mirror_ocp/">mirror_ocp</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_contentsourcepolicy/">ocp_contentsourcepolicy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ocp_simulate_disconnected_network/">ocp_simulate_disconnected_network</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../registry/">registry</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Suite Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_config/">suite_app_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_install/">suite_app_install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_uninstall/">suite_app_uninstall</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_upgrade/">suite_app_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_app_rollback/">suite_app_rollback</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_certs/">suite_certs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_config/">suite_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_db2_setup_for_manage/">suite_db2_setup_for_manage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_dns/">suite_dns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_install/">suite_install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_attachments_config/">suite_manage_attachments_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_birt_report_config/">suite_manage_birt_report_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_bim_config/">suite_manage_bim_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_customer_files_config/">suite_manage_customer_files_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_import_certs_config/">suite_manage_import_certs_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_load_dbc_scripts/">suite_manage_load_dbc_scripts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_logging_config/">suite_manage_logging_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_manage_pvc_config/">suite_manage_pvc_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_uninstall/">suite_uninstall</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_upgrade/">suite_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_rollback/">suite_rollback</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../suite_verify/">suite_verify</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Utilities</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ansible_version_check/">ansible_version_check</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../entitlement_key_rotation/">entitlement_key_rotation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gencfg_jdbc/">gencfg_jdbc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gencfg_watsonstudio/">gencfg_watsonstudio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gencfg_workspace/">gencfg_workspace</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../install_operator/">install_operator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../gencfg_mongo/">gencfg_mongo</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MAS Devops Collection</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Backup and Restore MAS Applications</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/roles/suite_app_backup_restore.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="backup-and-restore-mas-applications">Backup and Restore MAS Applications<a class="headerlink" href="#backup-and-restore-mas-applications" title="Permanent link"></a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link"></a></h2>
<p>This role supports backing up and restoring the data for below MAS applications:</p>
<ul>
<li><code>manage</code>: Manage namespace resources, persistent volume data (e.g. attachments)</li>
<li><code>iot</code>: IoT namespace resources</li>
<li><code>monitor</code>: Monitor namespace resources</li>
<li><code>health</code>: Health namespace resources, Watson Studio project asset</li>
<li><code>optimizer</code>: Optimizer namespace resources</li>
<li><code>visualinspection</code>: Visual Inspection namespace resources, persistent volume data (e.g. image datasets, models)</li>
</ul>
<p>Supports creating on-demand or scheduled backup jobs for taking full or incremental backups, and optionally creating Kubernetes jobs for running the backup/restore process.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>An application backup can only be restored to an instance with the same MAS instance ID.</p>
</div>
<h2 id="role-variables-general">Role Variables - General<a class="headerlink" href="#role-variables-general" title="Permanent link"></a></h2>
<h3 id="masbr_action">masbr_action<a class="headerlink" href="#masbr_action" title="Permanent link"></a></h3>
<p>Set <code>backup</code> or <code>restore</code> to indicate the role to create a backup or restore job.</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MAS_BR_ACTION</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_app_id">mas_app_id<a class="headerlink" href="#mas_app_id" title="Permanent link"></a></h3>
<p>Defines the MAS application ID (<code>manage</code>, <code>iot</code>, <code>monitor</code>, <code>health</code>, <code>optimizer</code>, or <code>visualinspection</code>) for the backup or restore action.</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MAS_APP_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_instance_id">mas_instance_id<a class="headerlink" href="#mas_instance_id" title="Permanent link"></a></h3>
<p>Defines the MAS instance ID for the backup or restore action.</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MAS_INSTANCE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="mas_workspace_id">mas_workspace_id<a class="headerlink" href="#mas_workspace_id" title="Permanent link"></a></h3>
<p>Defines the MAS workspace ID for the backup or restore action.</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MAS_WORKSPACE_ID</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_confirm_cluster">masbr_confirm_cluster<a class="headerlink" href="#masbr_confirm_cluster" title="Permanent link"></a></h3>
<p>Set <code>true</code> or <code>false</code> to indicate the role whether to confirm the currently connected cluster before running the backup or restore job.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_CONFIRM_CLUSTER</code></li>
<li>Default: <code>false</code></li>
</ul>
<h3 id="masbr_copy_timeout_sec">masbr_copy_timeout_sec<a class="headerlink" href="#masbr_copy_timeout_sec" title="Permanent link"></a></h3>
<p>Set the transfer files timeout in seconds.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_COPY_TIMEOUT_SEC</code></li>
<li>Default: <code>43200</code> (12 hours)</li>
</ul>
<h3 id="masbr_job_timezone">masbr_job_timezone<a class="headerlink" href="#masbr_job_timezone" title="Permanent link"></a></h3>
<p>Set the <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">time zone</a> for creating scheduled backup job. If not set a value for this variable, this role will use UTC time zone when creating a CronJob for running scheduled backup job.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_JOB_TIMEZONE</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_storage_type">masbr_storage_type<a class="headerlink" href="#masbr_storage_type" title="Permanent link"></a></h3>
<p>Set <code>local</code> or <code>cloud</code> to indicate this role to save the backup files to local file system or cloud object storage.</p>
<ul>
<li><strong>Required</strong></li>
<li>Environment Variable: <code>MASBR_STORAGE_TYPE</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_storage_local_folder">masbr_storage_local_folder<a class="headerlink" href="#masbr_storage_local_folder" title="Permanent link"></a></h3>
<p>Set local path to save the backup files.</p>
<ul>
<li><strong>Required</strong> only when <code>MASBR_STORAGE_TYPE=local</code></li>
<li>Environment Variable: <code>MASBR_STORAGE_LOCAL_FOLDER</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_storage_cloud_rclone_file">masbr_storage_cloud_rclone_file<a class="headerlink" href="#masbr_storage_cloud_rclone_file" title="Permanent link"></a></h3>
<p>Set the path of <code>rclone.conf</code> file.</p>
<ul>
<li><strong>Required</strong> only when <code>MASBR_STORAGE_TYPE=cloud</code></li>
<li>Environment Variable: <code>MASBR_STORAGE_CLOUD_RCLONE_FILE</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_storage_cloud_rclone_name">masbr_storage_cloud_rclone_name<a class="headerlink" href="#masbr_storage_cloud_rclone_name" title="Permanent link"></a></h3>
<p>Set the configuration name defined in <code>rclone.conf</code> file.</p>
<ul>
<li><strong>Required</strong> only when <code>MASBR_STORAGE_TYPE=cloud</code></li>
<li>Environment Variable: <code>MASBR_STORAGE_CLOUD_RCLONE_NAME</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_storage_cloud_bucket">masbr_storage_cloud_bucket<a class="headerlink" href="#masbr_storage_cloud_bucket" title="Permanent link"></a></h3>
<p>Set the object storage bucket name for saving the backup files</p>
<ul>
<li><strong>Required</strong> only when <code>MASBR_STORAGE_TYPE=cloud</code></li>
<li>Environment Variable: <code>MASBR_STORAGE_CLOUD_BUCKET</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_slack_enabled">masbr_slack_enabled<a class="headerlink" href="#masbr_slack_enabled" title="Permanent link"></a></h3>
<p>Set <code>true</code> or <code>false</code> to indicate whether this role will send Slack notification messages of the backup and restore progress.  </p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_SLACK_ENABLED</code></li>
<li>Default: <code>false</code></li>
</ul>
<h3 id="masbr_slack_level">masbr_slack_level<a class="headerlink" href="#masbr_slack_level" title="Permanent link"></a></h3>
<p>Set <code>failure</code>, <code>info</code> or <code>verbose</code> to indicate this role to send Slack notification messages in which backup and resore phases:</p>
<table>
<thead>
<tr>
<th>Slack level</th>
<th>Backup/Restore phases</th>
</tr>
</thead>
<tbody>
<tr>
<td>failure</td>
<td><code>Failed</code>, <code>PartiallyFailed</code></td>
</tr>
<tr>
<td>info</td>
<td><code>Completed</code>, <code>Failed</code>, <code>PartiallyFailed</code></td>
</tr>
<tr>
<td>verbose</td>
<td><code>InProgress</code>, <code>Completed</code>, <code>Failed</code>, <code>PartiallyFailed</code></td>
</tr>
</tbody>
</table>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_SLACK_LEVEL</code></li>
<li>Default: <code>info</code></li>
</ul>
<h3 id="masbr_slack_token">masbr_slack_token<a class="headerlink" href="#masbr_slack_token" title="Permanent link"></a></h3>
<p>The Slack integration token.  </p>
<ul>
<li><strong>Required</strong> only when <code>MASBR_SLACK_ENABLED=true</code></li>
<li>Environment Variable: <code>MASBR_SLACK_TOKEN</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_slack_channel">masbr_slack_channel<a class="headerlink" href="#masbr_slack_channel" title="Permanent link"></a></h3>
<p>The Slack channel to send the notification messages to.</p>
<ul>
<li><strong>Required</strong> only when <code>MASBR_SLACK_ENABLED=true</code></li>
<li>Environment Variable: <code>MASBR_SLACK_CHANNEL</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_slack_user">masbr_slack_user<a class="headerlink" href="#masbr_slack_user" title="Permanent link"></a></h3>
<p>The sender of the Slack notification message.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_SLACK_USER</code></li>
<li>Default: <code>MASBR</code></li>
</ul>
<h2 id="role-variables-backup">Role Variables - Backup<a class="headerlink" href="#role-variables-backup" title="Permanent link"></a></h2>
<h3 id="masbr_backup_type">masbr_backup_type<a class="headerlink" href="#masbr_backup_type" title="Permanent link"></a></h3>
<p>Set <code>full</code> or <code>incr</code> to indicate the role to create a full backup or incremental backup. Only supports creating incremental backup for persistent volume data, this role will always create a full backup for other type of data regardless of whether this variable be set to <code>incr</code>.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_BACKUP_TYPE</code></li>
<li>Default: <code>full</code></li>
</ul>
<h3 id="masbr_backup_data">masbr_backup_data<a class="headerlink" href="#masbr_backup_data" title="Permanent link"></a></h3>
<p>Set the types of data to be backed up, multiple data types are separated by commas (e.g. <code>namespace,pv</code>). If not set a value for this variable, this role will back up all types of data that supported by the specified MAS application. The data types supported by each MAS applications:</p>
<table>
<thead>
<tr>
<th>MAS App Name</th>
<th>MAS App ID</th>
<th>Data types</th>
</tr>
</thead>
<tbody>
<tr>
<td>Manage</td>
<td><code>manage</code></td>
<td><code>namespace</code>, <code>pv</code></td>
</tr>
<tr>
<td>IoT</td>
<td><code>iot</code></td>
<td><code>namespace</code></td>
</tr>
<tr>
<td>Monitor</td>
<td><code>monitor</code></td>
<td><code>namespace</code></td>
</tr>
<tr>
<td>Health</td>
<td><code>health</code></td>
<td><code>namespace</code>, <code>wsl</code></td>
</tr>
<tr>
<td>Optimizer</td>
<td><code>optimizer</code></td>
<td><code>namespace</code></td>
</tr>
<tr>
<td>Visual Inspection</td>
<td><code>visualinspection</code></td>
<td><code>namespace</code>, <code>pv</code></td>
</tr>
</tbody>
</table>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_BACKUP_DATA</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_backup_from_version">masbr_backup_from_version<a class="headerlink" href="#masbr_backup_from_version" title="Permanent link"></a></h3>
<p>Set the full backup version to use in the incremental backup, this will be in the format of a <code>YYYMMDDHHMMSS</code> timestamp (e.g. <code>20240621021316</code>). This variable is only valid when <code>MASBR_BACKUP_TYPE=incr</code>. If not set a value for this variable, this role will try to find the latest full backup version from the specified storage location.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_BACKUP_FROM_VERSION</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_backup_schedule">masbr_backup_schedule<a class="headerlink" href="#masbr_backup_schedule" title="Permanent link"></a></h3>
<p>Set <a href="ttps://en.wikipedia.org/wiki/Cron">Cron expression</a> to create a scheduled backup. If not set a value for this varialbe, this role will create an on-demand backup.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_BACKUP_SCHEDULE</code></li>
<li>Default: None</li>
</ul>
<h2 id="role-variables-restore">Role Variables - Restore<a class="headerlink" href="#role-variables-restore" title="Permanent link"></a></h2>
<h3 id="masbr_restore_from_version">masbr_restore_from_version<a class="headerlink" href="#masbr_restore_from_version" title="Permanent link"></a></h3>
<p>Set the backup version to use in the restore, this will be in the format of a <code>YYYMMDDHHMMSS</code> timestamp (e.g. <code>20240621021316</code>)</p>
<ul>
<li><strong>Required</strong> only when <code>MAS_BR_ACTION=restore</code></li>
<li>Environment Variable: <code>MASBR_RESTORE_FROM_VERSION</code></li>
<li>Default: None</li>
</ul>
<h3 id="masbr_restore_data">masbr_restore_data<a class="headerlink" href="#masbr_restore_data" title="Permanent link"></a></h3>
<p>Set the types of data to be restored, multiple data types are separated by commas (e.g. <code>namespace,pv</code>). If not set a value for this variable, this role will restore all types of data that supported by the specified MAS application. The data types supported by each MAS applications:</p>
<table>
<thead>
<tr>
<th>MAS App Name</th>
<th>MAS App ID</th>
<th>Data types</th>
</tr>
</thead>
<tbody>
<tr>
<td>Manage</td>
<td><code>manage</code></td>
<td><code>namespace</code>, <code>pv</code></td>
</tr>
<tr>
<td>IoT</td>
<td><code>iot</code></td>
<td><code>namespace</code></td>
</tr>
<tr>
<td>Monitor</td>
<td><code>monitor</code></td>
<td><code>namespace</code></td>
</tr>
<tr>
<td>Health</td>
<td><code>health</code></td>
<td><code>namespace</code>, <code>wsl</code></td>
</tr>
<tr>
<td>Optimizer</td>
<td><code>optimizer</code></td>
<td><code>namespace</code></td>
</tr>
<tr>
<td>Visual Inspection</td>
<td><code>visualinspection</code></td>
<td><code>namespace</code>, <code>pv</code></td>
</tr>
</tbody>
</table>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_RESTORE_DATA</code></li>
<li>Default: None</li>
</ul>
<h2 id="role-variables-manage">Role Variables - Manage<a class="headerlink" href="#role-variables-manage" title="Permanent link"></a></h2>
<h3 id="masbr_manage_pvc_paths">masbr_manage_pvc_paths<a class="headerlink" href="#masbr_manage_pvc_paths" title="Permanent link"></a></h3>
<p>Set the Manage PVC paths to use in backup and restore. The PVC path is in the format of <code>&lt;pvcName&gt;:&lt;mountPath&gt;/&lt;subPath&gt;</code>. Multiple PVC paths are separated by commas (e.g. <code>pvc-docs:/doclinks/attachments,pvc-maxlogs:/maxlogs</code>). If not set a value for this variable, this role will not backup and restore persistent valumne data for Manage.</p>
<ul>
<li>Optional</li>
<li>Environment Variable: <code>MASBR_MANAGE_PVC_PATHS</code></li>
<li>Default: None</li>
</ul>
<h2 id="example-playbook">Example Playbook<a class="headerlink" href="#example-playbook" title="Permanent link"></a></h2>
<h3 id="backup">Backup<a class="headerlink" href="#backup" title="Permanent link"></a></h3>
<p>Backup Manage namespace resources, note that this does not include backup of any data in Db2, see the <code>backup</code> action in the <a href="../db2/">db2</a> role.</p>
<pre><code class="language-yaml">- hosts: localhost
  any_errors_fatal: true
  vars:
    masbr_action: backup
    mas_instance_id: main
    mas_workspace_id: ws1
    mas_app_id: manage
    masbr_storage_type: local
    masbr_storage_local_folder: /tmp/masbr
  roles:
    - ibm.mas_devops.suite_app_backup_restore
</code></pre>
<h3 id="restore">Restore<a class="headerlink" href="#restore" title="Permanent link"></a></h3>
<p>Restore Manage namespace resources, note that this does not include restore of any data in Db2, see the <code>restore</code> action in the <a href="../db2/">db2</a> role.</p>
<pre><code class="language-yaml">- hosts: localhost
  any_errors_fatal: true
  vars:
    masbr_action: restore
    masbr_restore_from_version: 20240621021316
    mas_instance_id: main
    mas_workspace_id: ws1
    mas_app_id: manage
    masbr_storage_type: local
    masbr_storage_local_folder: /tmp/masbr
  roles:
    - ibm.mas_devops.suite_app_backup_restore
</code></pre>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link"></a></h2>
<p>EPL-2.0</p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
