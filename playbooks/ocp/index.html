<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://ibm-mas.github.io/ansible-devops/playbooks/ocp/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>OCP - MAS Devops Collection</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "OCP";
        var mkdocs_page_input_path = "playbooks/ocp.md";
        var mkdocs_page_url = "/ansible-devops/playbooks/ocp/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> MAS Devops Collection
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../execution-environment/">Execution Environment</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Playbooks</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">OCP</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#provision">Provision</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#provision-on-aws-rosa">Provision on AWS ROSA</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#provision-on-ibmcloud-roks">Provision on IBMCloud ROKS</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#provision-on-ibm-devit-fyre">Provision on IBM DevIT Fyre</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#deprovision">Deprovision</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#deprovision-on-ibmcloud-roks">Deprovision on IBMCloud ROKS</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#deprovision-on-ibm-devit-fyre">Deprovision on IBM DevIT Fyre</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cp4d/">Install Cloud Pak For Data</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-core/">Install Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-aibroker/">Add AIBroker</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-iot/">Add IoT</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-manage/">Add Manage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-monitor/">Add Monitor</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-optimizer/">Add Optimizer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-predict/">Add Predict</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-visualinspection/">Add Visual Inspection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-update/">Update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../oneclick-upgrade/">Upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../uninstall-core/">Uninstall Core</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../backup-restore/">Backup & Restore</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: OCP Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_cluster_monitoring/">ocp_cluster_monitoring</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_config/">ocp_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_deprovision/">ocp_deprovision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_efs/">ocp_efs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_github_oauth/">ocp_github_oauth</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_login/">ocp_login</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_node_config/">ocp_node_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_provision/">ocp_provision</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_roks_upgrade_registry_storage/">ocp_roks_upgrade_registry_storage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_upgrade/">ocp_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_verify/">ocp_verify</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Dependency Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/appconnect/">appconnect</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/aws_bucket_access_point/">aws_bucket_access_point</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/aws_documentdb_user/">aws_documentdb_user</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/aws_policy/">aws_policy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/aws_route53/">aws_route53</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/aws_user_creation/">aws_user_creation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/aws_vpc/">aws_vpc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/cert_manager/">cert_manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/cis/">cis</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/common_services/">common-services</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/configure_manage_eventstreams/">configure_manage_eventstreams</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/cos/">cos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/cos_bucket/">cos_bucket</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_admin_pwd_update/">cp4d_admin_pwd_update</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d/">cp4d</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/cp4d_service/">cp4d_service</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/db2/">db2</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/dro/">dro</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/eck/">eck</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/grafana/">grafana</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ibm_catalogs/">ibm_catalogs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/kafka/">kafka</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/nvidia_gpu/">nvidia_gpu</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/mongodb/">mongodb</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocs/">ocs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/sls/">sls</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/turbonomic/">turbonomic</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/uds/">uds</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Image Mirroring</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/mirror_case_prepare/">mirror_case_prepare</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/mirror_extras_prepare/">mirror_extras_prepare</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/mirror_images/">mirror_images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/mirror_ocp/">mirror_ocp</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_contentsourcepolicy/">ocp_contentsourcepolicy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ocp_simulate_disconnected_network/">ocp_simulate_disconnected_network</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/registry/">registry</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Suite Mgmt</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_config/">suite_app_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_install/">suite_app_install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_uninstall/">suite_app_uninstall</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_upgrade/">suite_app_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_rollback/">suite_app_rollback</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_app_backup_restore/">suite_app_backup_restore</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_certs/">suite_certs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_config/">suite_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_db2_setup_for_manage/">suite_db2_setup_for_manage</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_dns/">suite_dns</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_install/">suite_install</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_attachments_config/">suite_manage_attachments_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_birt_report_config/">suite_manage_birt_report_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_bim_config/">suite_manage_bim_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_customer_files_config/">suite_manage_customer_files_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_import_certs_config/">suite_manage_import_certs_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_load_dbc_scripts/">suite_manage_load_dbc_scripts</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_logging_config/">suite_manage_logging_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_manage_pvc_config/">suite_manage_pvc_config</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_uninstall/">suite_uninstall</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_upgrade/">suite_upgrade</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_rollback/">suite_rollback</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_verify/">suite_verify</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/suite_backup_restore/">suite_backup_restore</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Roles: Utilities</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/ansible_version_check/">ansible_version_check</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/entitlement_key_rotation/">entitlement_key_rotation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/gencfg_jdbc/">gencfg_jdbc</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/gencfg_watsonstudio/">gencfg_watsonstudio</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/gencfg_workspace/">gencfg_workspace</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/install_operator/">install_operator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roles/gencfg_mongo/">gencfg_mongo</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">MAS Devops Collection</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Playbooks</li>
      <li class="breadcrumb-item active">OCP</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ibm-mas/ansible-devops/blob/master/docs/playbooks/ocp.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ocp-playbooks">OCP Playbooks<a class="headerlink" href="#ocp-playbooks" title="Permanent link"></a></h1>
<h2 id="provision">Provision<a class="headerlink" href="#provision" title="Permanent link"></a></h2>
<p>Refer to the <a href="../../roles/ocp_provision/">ocp_provision</a> role documentation for more information.</p>
<h3 id="provision-on-aws-rosa">Provision on AWS ROSA<a class="headerlink" href="#provision-on-aws-rosa" title="Permanent link"></a></h3>
<p>This playbook uses your ROSA API Token to provision a brand new OCP cluster, provision an instance of EFS and set up the cluster with a ReadWriteMany storage class named <code>efs</code> utilizing that instance.</p>
<p>To obtain your API token login to the <a href="https://console.redhat.com/openshift/token/rosa/show#">OpenShift cluster manager</a>.</p>
<pre><code class="language-bash">export AWS_ACCESS_KEY_ID=xxx
export AWS_SECRET_ACCESS_KEY=xxx
export ROSA_TOKEN=xxx

export CLUSTER_NAME=masonrosa
export OCP_VERSION=4.15
export ROSA_COMPUTE_NODES=5
export ROSA_CLUSTER_ADMIN_PASSWORD=xxx
ansible-playbook ibm.mas_devops.ocp_rosa_provision
</code></pre>
<h3 id="provision-on-ibmcloud-roks">Provision on IBMCloud ROKS<a class="headerlink" href="#provision-on-ibmcloud-roks" title="Permanent link"></a></h3>
<p>This playbook uses your IBMCloud API key to provision a brand new OCP cluster.</p>
<p>The playbook supports installing an IBM entitlement key as a cluster-wide image pull secret and reboot all worker nodes, which is required for IBM Cloud Pak for Data v4; this can be enabled by setting <code>REBOOT_WORKER_NODES</code> to <code>true</code> and providing the entitlement key with <code>CPD_ENTITLEMENT_KEY</code>.</p>
<p>This also supports upgrading the storage volume used for the cluster's internal image registry from 100Gb to 400Gb, this must be enabled by setting <code>UPGRADE_IMAGE_REGISTRY_STORAGE</code> to <code>true</code>.  This option is stringly recommended if you intend to install the Watson services from Cloud Pak for Data as the default volume size is too small.</p>
<pre><code class="language-bash">export CLUSTER_NAME=masinst1
export OCP_VERSION=4.15_openshift
export IBMCLOUD_APIKEY=xxx
export REBOOT_WORKER_NODES=true
export CPD_ENTITLEMENT_KEY=xxx
export UPGRADE_IMAGE_REGISTRY_STORAGE=true
ansible-playbook ibm.mas_devops.ocp_roks_provision
</code></pre>
<h3 id="provision-on-ibm-devit-fyre">Provision on IBM DevIT Fyre<a class="headerlink" href="#provision-on-ibm-devit-fyre" title="Permanent link"></a></h3>
<p>This playbook will provision a QuickBurn OCP cluster in IBM DevIT Fyre service, QuickBurn clusters will be automatically deprovisioned after 36 hours and are only suitable for small scale deployments for local development and demostration systems.</p>
<pre><code class="language-bash">export CLUSTER_NAME=masinst1
export OCP_VERSION=4.15
export FYRE_USERNAME=xxx
export FYRE_APIKEY=xxx
export FYRE_PRODUCT_ID=xxx

ansible-playbook ibm.mas_devops.ocp_fyre_provision
</code></pre>
<h2 id="deprovision">Deprovision<a class="headerlink" href="#deprovision" title="Permanent link"></a></h2>
<p>Refer to the <a href="../../roles/ocp_deprovision/">ocp_deprovision</a> role documentation for more information.</p>
<h3 id="deprovision-on-ibmcloud-roks">Deprovision on IBMCloud ROKS<a class="headerlink" href="#deprovision-on-ibmcloud-roks" title="Permanent link"></a></h3>
<pre><code class="language-bash">export CLUSTER_NAME=masinst1
export IBMCLOUD_APIKEY=xxx

ansible-playbook ibm.mas_devops.ocp_roks_deprovision
</code></pre>
<h3 id="deprovision-on-ibm-devit-fyre">Deprovision on IBM DevIT Fyre<a class="headerlink" href="#deprovision-on-ibm-devit-fyre" title="Permanent link"></a></h3>
<pre><code class="language-bash">export CLUSTER_NAME=masinst1
export FYRE_USERNAME=xxx
export FYRE_APIKEY=xxx

ansible-playbook ibm.mas_devops.ocp_fyre_deprovision
</code></pre>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ibm-mas/ansible-devops" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../execution-environment/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../cp4d/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
